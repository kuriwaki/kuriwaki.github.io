<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>MPA-ID 2019 Math Camp: R Session Slides</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link rel="stylesheet" href="xaringan_style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# MPA-ID 2019 Math Camp: R Session Slides
## Shiro Kuriwaki

---

class: middle










.pull-left[

# Table of Contents

* [&lt;b&gt;Day 1: tidyverse&lt;/b&gt;](#day1)
    * [dplyr](#day01-dplyr)
    * [ggplot](#day01-ggplot)
* [&lt;b&gt;Day 2: Beyond the tidyverse (base-R)&lt;/b&gt;](#day2)
    * [functions](#day02-functions)
    * [base-R syntax](#day02-base-R)
    * [function syntax](#day02-formula)
* [&lt;b&gt;Day 3: Visualization&lt;/b&gt;](#day3)
    * [principles](#day03-principles)
    * [technicalities](#day04-technicalities)
* [&lt;b&gt;Day 4: Workflow&lt;/b&gt;](#day4)
    * [workflow](#day04-workflow)
    * [downloading R Desktop](#day04-download-rstudio)
* [Day 5: Setup and RStudio Desktop](#day5)
    * [desktop](#day05-desktop)
    * [asking for help](#day05-getting-help)

]

.pull-right[

# About these slides

These slides were prepared for the MPA-ID cohort's 2019 Math Camp. See it in conjunction with the &lt;a href="https://www.shirokuriwaki.com/programming/2019%20Math%20Camp%20R%20Syllabus.pdf"&gt;syllabus&lt;/a&gt; for more resources.

Slides are originally compiled in HTML, so for best results see the &lt;a href="https://www.shirokuriwaki.com/programming/2019-math-camp-R_all-days.html"&gt;web version&lt;/a&gt; on a browser. The PDF version is a print-out of the version, so may crops out code windows that could be scrolled across horizontally in the web version.

Contact Shiro Kuriwaki (kuriwaki@g.harvard.edu) for more information.

]

---

# 5-day Schedule

&lt;img src="images/data-science.png" width="80%" style="display: block; margin: auto;" /&gt;

.small[Source: Grolemund and Wickham, R for Data Science]

---

# 5-day Schedule


.pull-left[
## Topics

1. Mastering R basics in tidyverse 
2. Mastering R basics beyond tidyverse
3. Perfecting Graphs
4. Exporting and Presenting
5. Presentations, preparing for classes

.small[\* See &lt;a href="https://www.shirokuriwaki.com/programming/2019%20Math%20Camp%20R%20Syllabus.pdf"&gt;syllabus&lt;/a&gt; for details]
]



--

.pull-right[

## Logistics


1. Login to &lt;https://rstudio.cloud&gt; and go to the Math Camp class space
2. "Copy" the Day 1 project `02_Day-01`, which includes
  - datasets
  - exercise PDF
  - relevant packages
3. During slides, try the code yourself + consult the cheatsheet: &lt;http://bit.ly/HKS-R&gt;
4. Work in groups for exercises (in your own R scripts)
5. Interrupt with questions and give me feedback on your index cards.

]

---
layout: true
&lt;div class="my-footer"&gt;&lt;span&gt;Day 1&lt;/span&gt;&lt;/div&gt;


---
class: middle
name: day1

# Day 1: Basics of tidyverse

## dplyr verbs
## ggplot aesthetics
## functions

.small-note[
**Notes:**


\* References for today's material: &lt;a href = "https://r4ds.had.co.nz"&gt;&lt;i&gt;R for Data Science&lt;/i&gt;&lt;/a&gt;  chs. &lt;a href = "https://r4ds.had.co.nz/data-visualisation.html"&gt;3&lt;/a&gt;, &lt;a href ="https://r4ds.had.co.nz/workflow-basics.html"&gt;4&lt;/a&gt;, and &lt;a href ="https://r4ds.had.co.nz/transform.html"&gt;5&lt;/a&gt;; as well as the &lt;a href = "https://rstudio.cloud/learn/primers"&gt;Primers&lt;/a&gt; and &lt;a href = "https://style.tidyverse.org"&gt;style guide&lt;/a&gt; from the summer.
]

---

# What is tidyverse?

* A popular suite of R packages
* Has its own syntax, designed to be more intuitive

--

&lt;br&gt;

&lt;mark&gt;For someone who does not know ANY programming, which of these two is more intuitive?&lt;/mark&gt;

--

.pull-left[

## (a) tidyverse syntax


```r
weo_dataset %&gt;% 
  group_by(continent) %&gt;% 
	summarize(gdp = median(rgdp2017, na.rm = TRUE))
```

]

.pull-right[

## (b) base-R syntax


```r
aggregate(weo_dataset[, "rgdp2017"], 
          list(continent = weo_dataset[, "continent"]), 
          median, na.rm = TRUE)
```

]

--

.small[.right[Source: Adapted from Roger Peng, &lt;a href= "https://simplystatistics.org/2018/07/12/use-r-keynote-2018/"&gt;"Teaching R to New Users - From tapply to the Tidyverse"&lt;/a&gt;]]

---

# If learning R is like "learning a language", R is a very _fast-evolving_ language

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

&lt;img src="images/tikz_timeline.png" width="120%" style="display: block; margin: auto;" /&gt;

---
class: left

# tidyverse simplifies data analysis by focusing on "tidy" rectangular data. 


```r
weo &lt;- read_excel("data/input/WEO-2018.xlsx")
```

.small[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; continent &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop1992 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rgdp1992 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop1994 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop1995 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop1996 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop1997 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop1998 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; pop1999 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; NA &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Albania &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Europe &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.217 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9728.893 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.137 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.141 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.168 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.148 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.129 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.109 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Algeria &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Africa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 26.271 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 267807.178 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27.496 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28.060 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28.566 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29.045 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29.507 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29.965 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Angola &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Africa &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13.459 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 39709.339 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.279 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.707 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.148 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.603 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.071 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.553 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Antigua and Barbuda &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; North America &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.062 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1133.675 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.065 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.067 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.068 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.070 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.072 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.074 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Argentina &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; South America &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 33.420 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 445025.532 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34.353 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34.779 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 35.196 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 35.604 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 36.005 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 36.399 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Armenia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Asia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.450 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7153.161 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.290 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.220 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.170 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.140 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.110 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.090 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Australia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Oceania &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17.557 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 507554.453 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17.893 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18.120 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18.330 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18.510 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18.706 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18.919 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]


---
name: day01-dplyr

# The `dplyr` package


* __94 percent__ of you responded being "Very Comfortable" or "Comfortable" using Excel

--

* `dplyr` ["dee" - plier] is a package that provides common spreadsheet manipulations

--

## single verbs

.pull-left[

* `filter()`: Return __rows__ with matching conditions
* `select()`: Select/rename __variables__ by name
* `arrange()`: Arrange rows by variables
* `mutate()`: Create or transform variables
* `summarize()`: Reduce multiple values down to a single value

* `%&gt;%` ["and then"]: Pipe left hand-side into right hand side

]

.pull-right[


```r
weo %&gt;% filter(continent == "Europe")
```


```r
weo %&gt;% arrange(rgdp2010)
```


```r
weo %&gt;% select(rgdp2010)
```


```r
weo %&gt;% mutate(gdp_pc_2010 = rgdp2010 / pop2010)
```


```r
weo %&gt;% summarize(median_pop_2017 = median(pop2017))
```

]


---

# A good package offers tools for common use cases

--


## selecting the first 10 columns


```r
weo %&gt;% select(1:10)
```

## selecting values from 1992 (i.e., variables that include the number 1992.)


```r
weo %&gt;% select(matches("1992"))
```

## select and rename 


```r
weo %&gt;% select(country, continent, `real_gdp_2017 = `rgdp2017)
```

## move 2017 to the beginning


```r
weo %&gt;% select(country, continent, matches("2017"), `everything()`)
```


See the help page of `?select` for more.

---

# A common summary -- counting


```r
count(weo, continent)
```

```
## # A tibble: 6 x 2
##   continent         n
##   &lt;chr&gt;         &lt;int&gt;
## 1 Africa           55
## 2 Asia             43
## 3 Europe           45
## 4 North America    22
## 5 Oceania          13
## 6 South America    13
```

---

# Cross-tabulation via counting

## A new dataset with categorical variables

.pull-left[

```r
data(gss_cat)
count(gss_cat, race)
```

```
## # A tibble: 3 x 2
##   race      n
##   &lt;fct&gt; &lt;int&gt;
## 1 Other  1959
## 2 Black  3129
## 3 White 16395
```


```r
count(gss_cat, race, `sort = TRUE`)
```

```
## # A tibble: 3 x 2
##   race      n
##   &lt;fct&gt; &lt;int&gt;
## 1 White 16395
## 2 Black  3129
## 3 Other  1959
```

]

--

.pull-right[

```r
count(gss_cat, race, relig)
```

```
## # A tibble: 44 x 3
##    race  relig                       n
##    &lt;fct&gt; &lt;fct&gt;                   &lt;int&gt;
##  1 Other No answer                  14
##  2 Other Don't know                  3
##  3 Other Inter-nondenominational     2
##  4 Other Native american            16
##  5 Other Christian                  74
##  6 Other Orthodox-christian          1
##  7 Other Moslem/islam               42
##  8 Other Other eastern              10
##  9 Other Hinduism                   62
## 10 Other Buddhism                   72
## # … with 34 more rows
```
]

---

# Doing more with dplyr: `group_by`


```r
weo %&gt;% 
* group_by(continent) %&gt;%
  summarize(median_gdp_pc = median(rgdp2017 / pop2017))
```

```
## # A tibble: 6 x 2
##   continent     median_gdp_pc
##   &lt;chr&gt;                 &lt;dbl&gt;
## 1 Africa                3180.
## 2 Asia                 15443.
## 3 Europe               30082.
## 4 North America        14484.
## 5 Oceania               5109.
## 6 South America        13194.
```

--

&lt;mark&gt;How would you write the equivalent of `count` with `group_by`?&lt;/mark&gt;

--


```r
weo %&gt;% 
  group_by(continent) %&gt;% 
  summarize(n = n())
```

---

# Grouping + dplyr verbs is a large part of data analysis


.left-code-wide[

```r
drop_inc &lt;- c("No answer", "Not applicable", "Don't know", "Refused")
gop_ind &lt;- c("Not str republican", "Strong republican")

gss_cat %&gt;% 
  filter(race != "Other", 
         !rincome %in% drop_inc) %&gt;% 
  mutate(race = fct_infreq(race)) %&gt;% 
* group_by(race, rincome) %&gt;%
  summarize(is_R = mean(partyid %in% gop_ind)) %&gt;% 
  pivot_wider(id_cols = rincome, 
              names_from = race,
              values_from = is_R) %&gt;% 
  kable(format = "html", 
        digits = 2,
        col.names = c("Income", "Whites", "Blacks")) %&gt;% 
  add_header_above(c(" " = 1, "% Strong Republican among" = 2))
```

.small[\* don't worry about the code for now. The only point here is that `group_by` is crucial.]
]

.right-plot-narrow[
.small[
&lt;table&gt;
 &lt;thead&gt;
&lt;tr&gt;
&lt;th style="border-bottom:hidden" colspan="1"&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;% Strong Republican among&lt;/div&gt;&lt;/th&gt;
&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Income &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Whites &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Blacks &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; $25000 or more &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.34 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.05 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; $20000 - 24999 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.28 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.05 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; $15000 - 19999 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.27 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.03 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; $10000 - 14999 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.25 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.06 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; $8000 to 9999 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.23 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.11 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; $7000 to 7999 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; $6000 to 6999 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.26 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.03 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; $5000 to 5999 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.28 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.08 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; $4000 to 4999 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.08 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; $3000 to 3999 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.26 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.10 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; $1000 to 2999 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.27 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Lt $1000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.04 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]
]


---

# Introducing a new dataset

.pull-left[

The WEO dataset in "long" form



```r
weo_long
```

```
## # A tibble: 6,112 x 5
##    country     continent  year   pop  rgdp
##    &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Afghanistan Asia       1992    NA    NA
##  2 Afghanistan Asia       1993    NA    NA
##  3 Afghanistan Asia       1994    NA    NA
##  4 Afghanistan Asia       1995    NA    NA
##  5 Afghanistan Asia       1996    NA    NA
##  6 Afghanistan Asia       1997    NA    NA
##  7 Afghanistan Asia       1998    NA    NA
##  8 Afghanistan Asia       1999    NA    NA
##  9 Afghanistan Asia       2000    NA    NA
## 10 Afghanistan Asia       2001    NA    NA
## # … with 6,102 more rows
```


]

--

.pull-right[

compare this to the original "wide" form....


```r
weo
```

```
## # A tibble: 191 x 66
##    country continent pop1992 pop1993 pop1994 pop1995 pop1996 pop1997
##    &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Afghan… Asia       NA      NA      NA      NA      NA       NA   
##  2 Albania Europe      3.22    3.20    3.14    3.14    3.17     3.15
##  3 Algeria Africa     26.3    26.9    27.5    28.1    28.6     29.0 
##  4 Angola  Africa     13.5    13.9    14.3    14.7    15.1     15.6 
##  5 Antigu… North Am…   0.062   0.063   0.065   0.067   0.068    0.07
##  6 Argent… South Am…  33.4    33.9    34.4    34.8    35.2     35.6 
##  7 Armenia Asia        3.45    3.37    3.29    3.22    3.17     3.14
##  8 Austra… Oceania    17.6    17.7    17.9    18.1    18.3     18.5 
##  9 Austria Europe      7.80    7.88    7.93    7.95    7.96     7.97
## 10 Azerba… Asia        7.46    7.49    7.60    7.64    7.73     7.8 
## # … with 181 more rows, and 58 more variables: pop1998 &lt;dbl&gt;,
## #   pop1999 &lt;dbl&gt;, pop2000 &lt;dbl&gt;, pop2001 &lt;dbl&gt;, pop2002 &lt;dbl&gt;,
## #   pop2003 &lt;dbl&gt;, pop2004 &lt;dbl&gt;, pop2005 &lt;dbl&gt;, pop2006 &lt;dbl&gt;,
## #   pop2007 &lt;dbl&gt;, pop2008 &lt;dbl&gt;, pop2009 &lt;dbl&gt;, pop2010 &lt;dbl&gt;,
## #   pop2011 &lt;dbl&gt;, pop2012 &lt;dbl&gt;, pop2013 &lt;dbl&gt;, pop2014 &lt;dbl&gt;,
## #   pop2015 &lt;dbl&gt;, pop2016 &lt;dbl&gt;, pop2017 &lt;dbl&gt;, pop2018 &lt;dbl&gt;,
## #   pop2019 &lt;dbl&gt;, pop2020 &lt;dbl&gt;, pop2021 &lt;dbl&gt;, pop2022 &lt;dbl&gt;,
## #   pop2023 &lt;dbl&gt;, rgdp1992 &lt;dbl&gt;, rgdp1993 &lt;dbl&gt;, rgdp1994 &lt;dbl&gt;,
## #   rgdp1995 &lt;dbl&gt;, rgdp1996 &lt;dbl&gt;, rgdp1997 &lt;dbl&gt;, rgdp1998 &lt;dbl&gt;,
## #   rgdp1999 &lt;dbl&gt;, rgdp2000 &lt;dbl&gt;, rgdp2001 &lt;dbl&gt;, rgdp2002 &lt;dbl&gt;,
## #   rgdp2003 &lt;dbl&gt;, rgdp2004 &lt;dbl&gt;, rgdp2005 &lt;dbl&gt;, rgdp2006 &lt;dbl&gt;,
## #   rgdp2007 &lt;dbl&gt;, rgdp2008 &lt;dbl&gt;, rgdp2009 &lt;dbl&gt;, rgdp2010 &lt;dbl&gt;,
## #   rgdp2011 &lt;dbl&gt;, rgdp2012 &lt;dbl&gt;, rgdp2013 &lt;dbl&gt;, rgdp2014 &lt;dbl&gt;,
## #   rgdp2015 &lt;dbl&gt;, rgdp2016 &lt;dbl&gt;, rgdp2017 &lt;dbl&gt;, rgdp2018 &lt;dbl&gt;,
## #   rgdp2019 &lt;dbl&gt;, rgdp2020 &lt;dbl&gt;, rgdp2021 &lt;dbl&gt;, rgdp2022 &lt;dbl&gt;,
## #   rgdp2023 &lt;dbl&gt;
```

]


---

# groups in ggplot

## simple case: single time trend
.left-code[

```r
gdp_by_year &lt;- weo_long %&gt;% 
  group_by(year) %&gt;% 
  summarize(med_gdp = median(rgdp, na.rm = TRUE),
            gdp_pc = sum(rgdp, na.rm = TRUE) / 
              sum(pop, na.rm = TRUE))

ggplot(gdp_by_year, aes(x = year, y = med_gdp)) +
  geom_line() +
  labs(y = "Median GDP (in millions 2017 USD)")
```
]

--


.right-plot[
![](2019-math-camp-R_all-days_files/figure-html/lineall-out-1.svg)&lt;!-- --&gt;
]

---

# groups in ggplot

## what's wrong here?

.left-code[

```r
ggplot(weo_long, aes(x = year,  y = rgdp)) +
  geom_line() +
  labs(y = "GDP (in millions 2017 USD)")
```
]

.right-plot[
![](2019-math-camp-R_all-days_files/figure-html/linectybad-out-1.svg)&lt;!-- --&gt;
]

---

# groups in ggplot

## the group aesthetic treats a group of observations, defined by another variable, separately

.left-code[

```r
ggplot(weo_long, 
*      aes(x = year, y = rgdp, group = country)) +
  geom_line() +
  labs(y = "GDP (in millions 2017 USD)")
```
]

.right-plot[
![](2019-math-camp-R_all-days_files/figure-html/linecty-out-1.svg)&lt;!-- --&gt;
]

---

# groups in ggplot


.left-code[

```r
weo_large &lt;- weo_long %&gt;% 
  filter(country %in% c(
    "India",
    "China",
    "Japan",
    "South Korea",
    "United States"
  ))


ggplot(weo_large, 
*      aes(x = year, y = rgdp, group = country)) +
  geom_line() +
  labs(y = "GDP (in millions 2017 USD)")
```
]

.right-plot[
![](2019-math-camp-R_all-days_files/figure-html/linectysub-out-1.svg)&lt;!-- --&gt;
]

---
class: middle, center
name: day01-ggplot


# The grammar of graphics


---
# 3 required components of ggplot grammar: data, aesthetic mapping, and geoms


&lt;img src="images/ggplot-grammar.png" width="60%" style="display: block; margin: auto;" /&gt;

---

# mapping vs. layers and the global application of geoms

.left-threeway[


```r
#
ggplot(data = gdp_by_year, 
       aes(x = year, y = gdp_pc)) +
* geom_point() +
  labs(x = "Year",
       y = "GDP per capita")
```

&lt;img src="2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-28-1.svg" width="100%" /&gt;

]

--

.center-threeway[

```r
#
ggplot(data = gdp_by_year, 
       aes(x = year, y = gdp_pc)) +
* geom_line() +
  labs(x = "Year",
       y = "GDP per capita")
```

&lt;img src="2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-29-1.svg" width="100%" /&gt;

]

--

.right-threeway[


```r
ggplot(data = gdp_by_year, 
       aes(x = year, y = gdp_pc)) +
* geom_point() +
* geom_line() +
  labs(x = "Year",
       y = "GDP per capita")
```

&lt;img src="2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-30-1.svg" width="100%" /&gt;

]

---

# mappings vs. hard-coded values

.left-threeway[

```r
ggplot(data = gdp_by_year, 
       aes(x = year, y = gdp_pc)) +
* geom_point(aes(color = gdp_pc)) +
  labs(x = "Year",
       y = "GDP per capita")
```

&lt;img src="2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-31-1.svg" width="100%" /&gt;

]

--



.center-threeway[

```r
ggplot(data = gdp_by_year, 
       aes(x = year, y = gdp_pc)) +
* geom_line(color = "navy") +
  labs(x = "Year",
       y = "GDP per capita")
```

&lt;img src="2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-32-1.svg" width="100%" /&gt;

]

--



.right-threeway[


```r
ggplot(data = gdp_by_year, 
       aes(x = year, y = gdp_pc)) +
* geom_point(aes(color = "navy")) + # wrong!
  labs(x = "Year",
       y = "GDP per capita")
```

&lt;img src="2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-33-1.svg" width="100%" /&gt;

]



---

class: middle center

# Try the exercises provided in your RStudio day 1 space. 

---
layout: true
&lt;div class="my-footer"&gt;&lt;span&gt;Day 2&lt;/span&gt;&lt;/div&gt;

---
class: middle
name: day2

# Day 2 - R beyond the tidyverse

## Group project preview
## function anatomy
## base-R syntax: vectors and lists
## strings, factors, numerics, and coercion
## formula syntax cross-tabs

.small-note[
**Notes:**


\* References for today's material: &lt;a href = "https://r4ds.had.co.nz"&gt;&lt;i&gt;R for Data Science&lt;/i&gt;&lt;/a&gt;  chs. &lt;a href = "https://r4ds.had.co.nz/factors.html"&gt;15&lt;/a&gt;, &lt;a href = "https://r4ds.had.co.nz/pipes.html"&gt;18&lt;/a&gt;, and &lt;a href = "https://r4ds.had.co.nz/vectors.html"&gt;20&lt;/a&gt;; and &lt;a href = "https://rstudio-education.github.io/hopr"&gt;&lt;i&gt;Hands-on Programming with R&lt;/i&gt;&lt;/a&gt; chs. &lt;a href = "https://rstudio-education.github.io/hopr/basics.html"&gt;2&lt;/a&gt; through &lt;a href = "https://rstudio-education.github.io/hopr/r-notation"&gt;6&lt;/a&gt;.
]

---

class: middle

# Housekeeping

* Announcements by Dan and Jake
* How to get files and submit assignments on Canvas
* Open the rstudio cloud session for today (`03_Day-02`)
* Read in the datasets we'll use


```r
library(tidyverse)
library(readxl)

weo &lt;- read_excel("data/input/WEO-2018.xlsx")
weo_long &lt;- read_csv("data/input/WEO-2018_long.csv")
data(gss_cat)
```

* How to ask questions

---

# Group Project (8/27): How does climate change affect economic growth / politics?

.pull-left[

&lt;img src="images/nytimes-climate.png" width="100%" /&gt;

]

.pull-right[

We'll use data from:

&lt;img src="images/dell_et_al_abstract.png" width="100%" /&gt;

same format as `WEO-2018_long.csv`, contains temperature, precipitation, and growth data.

]

---

# Group Project (8/27): How does climate change affect economic growth / politics?


.pull-left[

## for next Tuesday:

Short Submission: A standalone &lt;mark&gt;graph / table&lt;/mark&gt; testing whether hot countries tend to be poor. 

Group Presentation: A data-driven &lt;mark&gt;report&lt;/mark&gt; showing if / how climate change affects growth.
 
 - Focus on the tools for data exploration and visualization we learn in math camp
 - That means: don't worry about the econometrics

]

.pull-right[

We'll use data from:

&lt;img src="images/dell_et_al_abstract.png" width="100%" /&gt;

same format as `WEO-2018_long.csv`, contains temperature, precipitation, and growth data.

]

---

class: middle




# Ready with your datasets?


```r
library(tidyverse)
library(readxl)

weo &lt;- read_excel("data/input/WEO-2018.xlsx")
weo_long &lt;- read_csv("data/input/WEO-2018_long.csv")
data(gss_cat)

gdp_by_year &lt;- weo_long %&gt;% 
  group_by(year) %&gt;% 
  summarize(med_gdp = median(rgdp, na.rm = TRUE))
```


---
class: middle, center
name: day02-functions


# Function Anatomy

---

* _function_ (in mathematics): a mapping from each element of a set `\(X\)` a _single_ element of a set `\(Y\)`"

    In R: a process that takes one or more inputs (in parentheses) and returns exactly one output
    
    ```r
    log(x = 100, base = 10)
    ```

--


* Call a function by the function name, with arguments and values in parentheses, separated by commas
    
    ```r
    log(x = 100, base = 10)
    log(base = 10, x = 100)
    ```

--



* If the user does not name the arguments, they are assumed to come in the order they are defined.
    
    ```r
    log(100, 10)
    ```

--


* &lt;mark&gt;How do you know that the &lt;b&gt;first&lt;/b&gt; argument of &lt;font face = "Ubuntu Mono"&gt;log()&lt;/font&gt; is &lt;font face = "Ubuntu Mono"&gt;x&lt;/font&gt;, and not &lt;font face = "Ubuntu Mono"&gt;base&lt;/font&gt;?&lt;/mark&gt;

---

# Function anatomy: important odds and ends

--

.pull-left[

## 1. functions with no output


These functions still do something, but they are side-effects (no object output)


```r
library(tidyverse)
```
.small[.right[(loads the package)]]

&lt;br&gt;


```r
data(gss_cat)
```
.small[.right[(loads a built-in dataset which will be called `gss_cat`)]]

]

--

.pull-right[

## 2. functions with no arguments



```r
Sys.Date()
```

```
## [1] "2019-09-05"
```

.small[.right[(prints the date regardless of input)]]


```r
n()
```
.small[.right[(`dplyr`s "the numbers of rows in")]]

]


---

.pull-left[

## 3. functions with default arguments


e.g. `log()` in R defaults to `\(\log_{e}()\)`:


```r
args(log)
```

```
## function (x, base = exp(1)) 
## NULL
```

therefore, an argument with a default can be left un-specified:


```r
log(exp(5))
```

_Note_ this is different from not declaring the _name_ for a no-default argument


```r
args(aes)
```

```
## function (x, y, ...) 
## NULL
```


```r
ggplot(gdp_by_year, aes(year, med_gdp))
```
]

--

.pull-right[

## 4. functions where defaults are not documented


```r
args(geom_point)
```

```
## function (mapping = NULL, data = NULL, stat = "identity", position = "identity", 
##     ..., na.rm = FALSE, show.legend = NA, inherit.aes = TRUE) 
## NULL
```



```r
ggplot(gdp_by_year, aes(year, med_gdp)) +
* geom_point() +
  labs(x = "Year", y = "GDP per capita")
```

&lt;img src="2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-52-1.svg" width="100%" /&gt;

]

---

## 5. functions with countably infinite arguments

.pull-left[


```r
count(x = gss_cat, race)
```
.right[.small[(one-way tabulation)]]


```r
count(x = gss_cat, race, relig)
```
.right[.small[(two-way tabulation)]]



```r
count(x = gss_cat, race, relig, denom)
```
.right[.small[(three-way tabulation)]]


Notice `args(count)` returns: 


```r
function (x, `...`, wt = NULL, sort = FALSE
```

R represents such potentially infinite arguments with `...` (an ellipsis)

]

--

.pull-right[


other arguments could be _named_


```r
count(gss_cat, race, relig, sort = TRUE)
```

```
## # A tibble: 44 x 3
##    race  relig          n
##    &lt;fct&gt; &lt;fct&gt;      &lt;int&gt;
##  1 White Protestant  8188
##  2 White Catholic    4001
##  3 White None        2816
##  4 Black Protestant  2271
##  5 Other Catholic     916
##  6 White Christian    474
##  7 Other Protestant   387
##  8 Black None         384
##  9 White Jewish       370
## 10 Other None         323
## # … with 34 more rows
```

so cannot be implicitly called. Consider:



```r
count(gss_cat, race, relig, TRUE) # wrong
```

]


--



---

## 6. dplyr's pipe

* tidyverse invented the `%&gt;%` for a convenient "and then"
  
  ```r
  weo %&gt;% 
      filter(continent == "Africa") %&gt;% 
      select(country, rgdp1992, pop1992) %&gt;% 
      mutate(gdp_pc = rgdp1992 / pop1992)
  ```

--

* The object to `%&gt;%`'s LEFT becomes the _value of the first argument_ of the function to `%&gt;%`'s RIGHT
  
  ```r
  weo %&gt;% 
  * filter(continent == "Africa")
  ```

--

* Therefore the first chunk is equivalent to:
  
  ```r
  mutate(select(filter(weo, continent == "Africa"), rgdp1992, pop1992), gdp_pc = rgdp1992 / pop1992)
  ```

.right[.small[Remark: this follows the formal definition of a function, but is much less readable]]

--

* &lt;font color = "gray"&gt;[Advanced]: A dataframe in a pipeline is implicitly kept "in scope", such that a variable name that is called is presumed to be from the dataframe. &lt;/font&gt;

---

## 7. ggplot's plus


.left-threeway[
* Historically, `ggplot` came before `tidyverse` and `dplyr`

* Appending layers by `+` (instead of `%&gt;%`) is a historical legacy

--

&lt;img src="images/ggplot-grammar.png" width="100%" style="display: block; margin: auto;" /&gt;

]

--


.right-plot[
.small[

```r
# format dataset
weo_percap &lt;- weo %&gt;% 
  mutate(pc_1992 = rgdp1992/pop1992,
         pc_2007 = rgdp2017/pop2017)

# ggplot
ggplot(weo_percap, aes(pc_1992, pc_2007)) +
  ## layers
  geom_abline(slope = 1, 
              intercept = 0, 
              linetype = "dashed") +
  geom_point(size = 0.5, color = "indianred") + 
  ## coordinate
  coord_equal() +
  ## facet 
  facet_wrap(~continent) +
  ## scale
  scale_x_continuous(labels = NULL) +
  scale_y_continuous(labels = dollar) +
  labs(x = "1992 GDP per capita",
       y = "2007 GDP per capita",
       title = "Growth between 1992 and 2017") +
  ## theme
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))
ggsave("images/day1gg-show.png", w  = 4.8, height = 3.2)
```
]
]

---

## 7. ggplot's plus


.left-code[
.small[

```r
# format dataset
weo_percap &lt;- weo %&gt;% 
  mutate(pc_1992 = rgdp1992/pop1992,
         pc_2007 = rgdp2017/pop2017)

# ggplot
ggplot(weo_percap, aes(pc_1992, pc_2007)) +
  ## layers
  geom_abline(slope = 1, 
              intercept = 0, 
              linetype = "dashed") +
  geom_point(size = 0.5, color = "indianred") + 
  ## coordinate
  coord_equal() +
  ## facet 
  facet_wrap(~continent) +
  ## scale
  scale_x_continuous(labels = NULL) +
  scale_y_continuous(labels = dollar) +
  labs(x = "1992 GDP per capita",
       y = "2007 GDP per capita",
       title = "Growth between 1992 and 2017") +
  ## theme
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold"))
ggsave("images/day1gg-show.png", w  = 4.8, height = 3.2)
```
]
]

.right-plot[
&lt;img src="images/day1gg-show.png" width="100%" style="display: block; margin: auto;" /&gt;

]

---
class: center, middle


# Questions?



---
name: day02-base-R


# Three broad flavors of syntax

## 1. tidyverse syntax



```r
weo `%&gt;%`
  `mutate(gdp_pc_2017 = rgdp2017 / pop2017)`
```

.right[.small[Create a new variable]]


## 2. base-R (dollar sign and square bracket) syntax


```r
weo`$`gdp_pc_2017 &lt;- weo`$`rgdp2017 / weo`$`pop2017
weo`[["`gdp_pc_2017`"]]` &lt;- weo`[["`rgdp2017`"]]` / weo`[["`pop2017`"]]`
```

.right[.small[Create a new variable]]

## 3. formula (tilde) syntax

.pull-left[



```r
lm(tvhours `~` race `+` relig, data = gss_cat)
```

.right[.small[Run regressions]]
]

.pull-right[

```r
xtabs(`~` race `+` relig, data = gss_cat)
```

.right[.small[Cross-tab]]

]

---
class: middle, center

# A Whirlwind Tour of Base-R

## Data structures
## Data types
## Summary functions


---

# Data Structures: what's the container?

## data frames is the most complex data structure

|      | Homogeneous     | Heterogeneous           |
| -----:| :-------------: |:-------------:|
| 1-dimensional| Atomic Vector   | List |
| 2-dimensional | Matrix   | &lt;mark&gt;Data frame&lt;/mark&gt; |

&lt;br&gt;


## "Heterogeneous" means it can take different types


```r
x &lt;- list(1:3, "a", c(TRUE, FALSE, TRUE), c(2.3, 5.9))
str(x)
```

```
## List of 4
##  $ : int [1:3] 1 2 3
##  $ : chr "a"
##  $ : logi [1:3] TRUE FALSE TRUE
##  $ : num [1:2] 2.3 5.9
```


---

# tidyverse vs. syntax have different ways of subsetting

.pull-left[

## tidyverse (dataframes only)


```r
weo %&gt;% 
  select(country, rgdp2017) %&gt;% 
  slice(1:5)
```

```
## # A tibble: 5 x 2
##   country             rgdp2017
##   &lt;chr&gt;                  &lt;dbl&gt;
## 1 Afghanistan           63353.
## 2 Albania               32763.
## 3 Algeria              576494.
## 4 Angola               173327.
## 5 Antigua and Barbuda    2174.
```


]



## base-R

.pull-right[

Atomic vectors with square brackets 

   
   ```r
   letters[c(1, 2, 3)]
   ```

Matrices also with square brackets -- with two dimensions:

   
   ```r
   weo[1:5, 1]
   ```


Lists with double square brackets or `$` (S for &lt;mark&gt;S&lt;/mark&gt;lot)

   
   ```r
   weo[[1]]
   weo[["country"]]
   weo$country
   ```

]




---

# Data types: what's in the container?

--

.left-threeway[

(a) Logical


```r
c(TRUE, FALSE, FALSE)
```

&lt;br&gt;


```r
is.na(c(NA, 2, 3))
```

```
## [1]  TRUE FALSE FALSE
```

]

.center-threeway[

(b) Numeric - Integers


```r
c(1L, 0L, 0L)
```

&lt;br&gt;


(c) Numeric - Doubles


```r
c(1, 0, 0)
```


]

.right-threeway[

(d) Character 


```r
c("A", "B", "B")
```

]


---

# Vectors are flexible:

.left-threeway[

## coercion

`TRUE` gets coerced to 1 and `FALSE` gets coerced to 0:


```r
sum(c(TRUE, FALSE, TRUE))
```

```
## [1] 2
```


numbers can be coerced to characters:


```r
as.character(c(1, 2, 3))
```


automatic coercion makes vectors stay homogeneous:


```r
c(1, "a")
```

]

--

.center-threeway[

## recycling

A scalar assigned to become a vector will be transformed into a _vector_ with its values repeated.


```r
weo$ones &lt;- 1
```

This created a column called `ones` where every row is the number ones.


```r
count(weo, ones)
```

```
## # A tibble: 1 x 2
##    ones     n
##   &lt;dbl&gt; &lt;int&gt;
## 1     1   191
```

]

--

.right-threeway[

## vector algebra

Numeric vectors and matrices follow the rules of algebra


```r
c(1, 2, 3) + c(100, 200, 300)
```

```
## [1] 101 202 303
```


```r
c(1, 2, 3) * c(100, 200, 300)
```

```
## [1] 100 400 900
```

recycling works here too:


```r
(c(1, 2, 3) * c(100, 200, 300)) + 1
```

```
## [1] 101 401 901
```


]

---


# factors: a hybrid type that encodes the order of values

--

* In practice, factors are like _ordered_ characters

--

* Technically,  factors integers (which dictates the ordering, called __levels__) where each value has a __label__

--

.pull-left[

## built-in GSS saves variables as factors 


```r
data(gss_cat)
count(gss_cat, marital)
```

```
## # A tibble: 6 x 2
##   marital           n
##   &lt;fct&gt;         &lt;int&gt;
## 1 No answer        17
## 2 Never married  5416
## 3 Separated       743
## 4 Divorced       3383
## 5 Widowed        1807
## 6 Married       10117
```
]

.pull-right[

## compare this to strings


```r
gss_str &lt;- read_csv("data/input/gss_str.csv")
count(gss_str, marital)
```

```
## # A tibble: 6 x 2
##   marital           n
##   &lt;chr&gt;         &lt;int&gt;
## 1 Divorced       3383
## 2 Married       10117
## 3 Never married  5416
## 4 No answer        17
## 5 Separated       743
## 6 Widowed        1807
```
]

---

# Recoding, Releveling, and Replacing


## 1. dplyr::recode edits the values


```r
gss_cat %&gt;% 
  mutate(relig = 
*          recode(relig,
*                 Protestant = "Christian",
*                 Catholic = "Christian",
*                 .default = "Non-Christian")) %&gt;%
  count(relig)
```

```
## # A tibble: 2 x 2
##   relig             n
##   &lt;fct&gt;         &lt;int&gt;
## 1 Non-Christian  5513
## 2 Christian     15970
```

---
# Recoding, Releveling, and Replacing


## 2. forcats::fct\_relevel edits the _order_ of the levels


```r
count(gss_cat, race)
```

```
## # A tibble: 3 x 2
##   race      n
##   &lt;fct&gt; &lt;int&gt;
## 1 Other  1959
## 2 Black  3129
## 3 White 16395
```


```r
gss_cat %&gt;% 
* mutate(race = fct_relevel(race, "White", "Black", "Other")) %&gt;%
  count(race)
```

```
## # A tibble: 3 x 2
##   race      n
##   &lt;fct&gt; &lt;int&gt;
## 1 White 16395
## 2 Black  3129
## 3 Other  1959
```

---
# Recoding, Releveling, and Replacing


## 3. base::replace edits the value of variables based on the value of potentially other variables



```r
gss_cat %&gt;% 
  mutate(is_senior = NA,  # this makes a columns of NAs
         is_senior = replace(is_senior, `age &lt; 65`,  "not senior"),
         is_senior = replace(is_senior, `age &gt;= 65`, "senior")) %&gt;% 
  select(age, is_senior)
```



```
## # A tibble: 21,483 x 2
##      age is_senior 
##    &lt;int&gt; &lt;chr&gt;     
##  1    26 not senior
##  2    48 not senior
##  3    67 senior    
##  4    39 not senior
##  5    25 not senior
##  6    25 not senior
##  7    36 not senior
##  8    44 not senior
##  9    44 not senior
## 10    47 not senior
## # … with 21,473 more rows
```


---

# The things you can get out of data

.pull-left[

## 1. dimensions


Each vector has a "length", each 2d array has a "dimension" 


```r
x &lt;- c(1:10)
length(x)
```


```
## [1] 10
```


```r
dim(weo)
```

```
## [1] 191  67
```


.right[.small[Also use  `nrow` (number of rows) and `ncol` (number of columns)]]

]

.pull-right[

## 2. summary stats




```r
stdnormals &lt;- rnorm(n = 1000, mean = 0, sd = 1)
```


```r
mean(stdnormals)
sd(stdnormals)
```


```
## [1] -0.007799939
```

```
## [1] 1.032668
```



```r
round(mean(stdnormals), digits = 2)
```

```
## [1] -0.01
```

]

---

# The things you can get out of data

.pull-left[

## 3. string concatenation


   
   ```r
   c("a", "b", "c", "d")
   ```
   
   ```
   ## [1] "a" "b" "c" "d"
   ```
concatenate ("paste") into a single item

   
   ```r
   str_c("a", "b", "c", "d")
   ```
   
   ```
   ## [1] "abcd"
   ```
   
]

--

.pull-right[

## 4. pulling out vectors from dataframes


```r
mean(weo$rgdp2019)
```

```
## [1] 653848.6
```



```r
mean(select(weo, rgdp2019))
```

```
## Warning in mean.default(select(weo, rgdp2019)): argument is not numeric or
## logical: returning NA
```

```
## [1] NA
```

"pull" takes one column and coerces to vector:


```r
mean(`pull`(weo, rgdp2019))
```


```
## [1] 653848.6
```

]

---


&lt;mark&gt; What would the following code do? &lt;/mark&gt;

   
   ```r
   weo_long %&gt;% 
     mutate(rgdp2017 = round(rgdp2017, digits = 0),
            country = str_c(country, " (", continent, ")")) %&gt;% 
     slice(1:3)
   ```

--

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; rgdp2017 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Afghanistan (Asia) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 63353 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Albania (Europe) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32763 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Algeria (Africa) &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 576494 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
class: center, middle
name: day02-formula


# Formula syntax


---

# Formula (tilde) syntax expresses the relationship between variables

.pull-left[
OLS has a `formula` and a `data` argument


```r
fit &lt;- lm(tvhours ~ race + relig, data = gss_cat)
summary(fit)
```

* __One__ variable (unquoted) to the left hand side
* __One or more__ variables to the right hand side

]

--


.pull-right[
Formulas are not unique to regressions. See for example cross-tabs:


```r
xtabs(~ relig + race, gss_cat, drop = TRUE)
```

* Typically no left hand side
* __One or two__ variables to the right hand side (row variable, then column variable)


]

---

# Summarizing cross-tabs

Cell / row / column proportions



```r
prop.table(xtabs(~ relig + race, gss_cat))
prop.table(xtabs(~ relig + race, gss_cat), `margin = 1`)
prop.table(xtabs(~ relig + race, gss_cat), `margin = 2`)
```

--

&lt;br&gt;

Using the GSS dataset, how would you get &lt;mark&gt;a cross-tab that shows (a) the proportion in each income bin, (b) for each of the two most common values of race, and (c) _rounded_ to the second decimal point?  &lt;/mark&gt;

--


```r
gss_cat_wb &lt;- gss_cat %&gt;% 
  filter(race %in% c("White", "Black")) %&gt;% 
  mutate(race = as.character(race))

xtabs(~ rincome + race, gss_cat_wb) %&gt;% 
  prop.table(margin = 2) %&gt;% 
  round(2)
```


---
layout: true
&lt;div class="my-footer"&gt;&lt;span&gt;Day 3&lt;/span&gt;&lt;/div&gt;




---
class: middle
name: day3

# Day 3 Agenda

## how our eyes see data
## technicalities: axes, legends, annotation, exporting


.small-note[
**Notes:**


\* References for today's material: &lt;a href = "https://r4ds.had.co.nz"&gt;&lt;i&gt;R for Data Science&lt;/i&gt;&lt;/a&gt;  ch. &lt;a href = "https://r4ds.had.co.nz/data-visualisation.html"&gt;2&lt;/a&gt;; &lt;a href = "https://serialmentor.com/dataviz/"&gt;&lt;i&gt;Fundamentals of Data Visualization&lt;/i&gt;&lt;/a&gt; by Claus Wilke; chs. &lt;a href = "https://serialmentor.com/dataviz/proportional-ink.html"&gt;17&lt;/a&gt; through &lt;a href = "https://serialmentor.com/dataviz/small-axis-labels.html"&gt;24&lt;/a&gt;; and &lt;a href = "https://www.youtube.com/watch?v=fSgEeI2Xpdc"&gt;&lt;i&gt;How Humans See Data&lt;/i&gt;&lt;/a&gt; by John Rauser. 

\* Most of the example graphs from this day are Claus Wilke's excellent book, and the presentation of the first section follows John Rauser's eye-opening talk. 
]

---
class: center, middle


# Visualization

&lt;br&gt;


---
name: day03-principles

# 1. Show the key message as a comparison of positions on a common scale

&lt;br&gt;

Perception tasks, ranked

1. &lt;u&gt;Position along a common scale&lt;/u&gt; &lt;font color = "red"&gt; &amp;#x2b05; the human eye can discern this most accurately &lt;/font&gt;
2. Position along identical, nonaligned scales
3. Length
4. Angle or Slope
5. Area
6. Volume, Density, Saturation
7. Color Hue  &lt;font color = "red"&gt; &amp;#x2b05; and this the least&lt;/font&gt;


.right[.small[Source: &lt;a href = "https://pdfs.semanticscholar.org/565d/843c2c0e60915709268ac4224894469d82d5.pdf"&gt;Cleveland and McGill (1985)&lt;/a&gt;, paper on Canvas]]





---

# Example: Alesina et al., "Intergenerational mobility in Africa" (&lt;a href="https://voxdev.org/topic/health-education/intergenerational-mobility-africa"&gt;link&lt;/a&gt;)


```r
alesina &lt;- read_excel("data/input/intergenerational-mobility.xlsx")
```

.pull-left[

&lt;img src="images/papaioannou21junefig1a.png" width="85%" /&gt;

]

--

.pull-right[


&lt;img src="images/papaioannou21junetable1.png" width="72%" /&gt;

]



---


.left-code[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

1. Position along a common scale &lt;font color = "red"&gt; &amp;#x2b05; the human eye can discern this most accurately &lt;/font&gt;
2. Position along identical, nonaligned scales
3. Length
4. Angle or Slope
5. Area
6. Volume, Density, Saturation
7. &lt;mark&gt;Color Hue&lt;/mark&gt;&lt;font color = "red"&gt; &amp;#x2b05; and this the least&lt;/font&gt;
]

--

.right-plot[

![](2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-119-1.svg)&lt;!-- --&gt;
]


---


.left-code[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

1. Position along a common scale &lt;font color = "red"&gt; &amp;#x2b05; the human eye can discern this most accurately &lt;/font&gt;
2. Position along identical, nonaligned scales
3. Length
4. Angle or Slope
5. Area
6. Volume, Density, Saturation
7. &lt;mark&gt;Color Hue&lt;/mark&gt;  &lt;font color = "red"&gt; &amp;#x2b05; and this the least&lt;/font&gt;

&lt;br&gt;
Using: `geom_col()` with the `fill` aesthetic, reordering countries by `fct_reorder()`.
]

.right-plot[

![](2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-120-1.svg)&lt;!-- --&gt;
]

---


.left-code[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

1. Position along a common scale &lt;font color = "red"&gt; &amp;#x2b05; the human eye can discern this most accurately &lt;/font&gt;
2. Position along identical, nonaligned scales
3. Length
4. Angle or Slope
5. Area
6. Volume, Density, &lt;mark&gt;Saturation&lt;/mark&gt;
7. Color Hue &lt;font color = "red"&gt; &amp;#x2b05; and this the least&lt;/font&gt;

&lt;br&gt;
Using: defining a color scale with `scale_fill_distiller(palette = "Reds")`.
]

.right-plot[

![](2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-121-1.svg)&lt;!-- --&gt;

]

---



.left-code[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

1. Position along a common scale &lt;font color = "red"&gt; &amp;#x2b05; the human eye can discern this most accurately &lt;/font&gt;
2. Position along identical, nonaligned scales
3. &lt;mark&gt;Length&lt;/mark&gt;
4. Angle or Slope
5. Area
6. Volume, Density, Saturation
7. Color Hue &lt;font color = "red"&gt; &amp;#x2b05; and this the least&lt;/font&gt;

&lt;br&gt;
Using: `geom_segment()`
]

.right-plot[

![](2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-122-1.svg)&lt;!-- --&gt;
]


---

.left-code[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

1. &lt;mark&gt;Position along a common scale&lt;/mark&gt; &lt;font color = "red"&gt; &amp;#x2b05; the human eye can discern this most accurately &lt;/font&gt;
2. Position along identical, nonaligned scales
3. Length
4. Angle or Slope
5. Area
6. Volume, Density, Saturation
7. Color Hue &lt;font color = "red"&gt; &amp;#x2b05; and this the least&lt;/font&gt;

&lt;br&gt;
Using: `geom_col()`
]


.right-plot[

![](2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-123-1.svg)&lt;!-- --&gt;
]


---

.left-code[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

1. &lt;mark&gt;Position along a common scale&lt;/mark&gt; &lt;font color = "red"&gt; &amp;#x2b05; the human eye can discern this most accurately &lt;/font&gt;
2. Position along identical, nonaligned scales
3. Length
4. Angle or Slope
5. Area
6. Volume, Density, Saturation
7. Color Hue &lt;font color = "red"&gt; &amp;#x2b05; and this the least&lt;/font&gt;

&lt;br&gt;
Using: `geom_point()`
]


.right-plot[

![](2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-124-1.svg)&lt;!-- --&gt;
]

---

.left-code[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

1. &lt;mark&gt;Position along a common scale&lt;/mark&gt; &lt;font color = "red"&gt; &amp;#x2b05; the human eye can discern this most accurately &lt;/font&gt;
2. Position along identical, nonaligned scales
3. Length
4. Angle or Slope
5. Area
6. Volume, Density, Saturation
7. Color Hue  &lt;font color = "red"&gt; &amp;#x2b05; and this the least&lt;/font&gt;

&lt;br&gt;
Using: `geom_point()`
]


.right-plot[

![](2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-125-1.svg)&lt;!-- --&gt;
]

---

.left-code[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

1. &lt;mark&gt;Position along a common scale&lt;/mark&gt; &lt;font color = "red"&gt; &amp;#x2b05; the human eye can discern this most accurately &lt;/font&gt;
2. Position along identical, nonaligned scales
3. Length
4. Angle or Slope
5. Area
6. Volume, Density, Saturation
7. Color Hue&lt;font color = "red"&gt; &amp;#x2b05; and this the least&lt;/font&gt;

&lt;br&gt;
Using: `geom_point()` and `geom_errorbar()`
]

.right-plot[

![](2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-126-1.svg)&lt;!-- --&gt;
]

---

.left-code[
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

1. &lt;mark&gt;Position along a common scale&lt;/mark&gt; &lt;font color = "red"&gt; &amp;#x2b05; the human eye can discern this most accurately &lt;/font&gt;
2. Position along identical, nonaligned scales
3. Length
4. Angle or Slope
5. Area
6. Volume, Density, Saturation
7. Color Hue &lt;font color = "red"&gt; &amp;#x2b05; and this the least&lt;/font&gt;

&lt;br&gt;
Using: `geom_point()` and `geom_errorbar()`
]


.right-plot[

![](2019-math-camp-R_all-days_files/figure-html/unnamed-chunk-127-1.svg)&lt;!-- --&gt;
]

---

# 1. Show the key message as a comparison of positions on a common scale




&lt;img src="images/how-humans-see.png" width="100%" style="display: block; margin: auto;" /&gt;

---

# 2. Maximize the Data-to-Ink ratio (i.e. proactively remove superficial ink)


&lt;img src="images/cwilke_table-examples-1.png" width="75%" style="display: block; margin: auto;" /&gt;



---

# 3. Avoid excessive overlap (instead, use small multiples)

.pull-left[

## bad

&lt;img src="images/cwilke_popgrowth-vs-popsize-colored-1.png" width="80%" /&gt;

]

.pull-right[

## bad
&lt;img src="images/papaioannou21junefig4.png" width="789" /&gt;


]

---


**Solution**:  In ggplot, "facet" your graphs by `facet_grid()` (a rigid table) or `facet_wrap()` (wrap long lines).


```r
ggplot(weo_long, aes(x = year, y = (rgdp/pop), group = country)) +
* facet_wrap(~ continent) + # formula syntax
  geom_line() +
  labs(x = "Year", y = "GDP per capita")
```

&lt;img src="images/country_facet.png" width="75%" /&gt;

---
class: center, middle


&lt;mark&gt;Try Problem 7 part (1) &lt;/mark&gt;



---
class: center, middle
name: day03-technicalities


# Important Technicalities




---

# 1. Clear and concise axis titles

## Always label your axes, but don't make it verbose either

.pull-left[

&lt;img src="images/cwilke_tech-stocks-minimal-labeling-bad-1.png" width="1536" /&gt;

]

.pull-right[

&lt;img src="images/cwilke_tech-stocks-labeling-ugly-1.png" width="1536" /&gt;

]

---

# 1. Clear and concise axis titles


.pull-left[
&lt;img src="images/cwilke_tech-stocks-minimal-labeling-1.png" width="1536" /&gt;
]

.pull-right[

pseudo-code:


```r
ggplot(stocks, 
       aes(x = year, 
           y = price, 
           group = company,
           color = company)) + 
* labs(x = "",
*      y = "stock price, indexed",
*      color = "")
```
]



---

# 2. Reasonable font and image sizes

## The default image size is almost always too large, making the labels illegible 

.pull-left[

&lt;img src="images/cwilke_Aus-athletes-small-1.png" width="1536" /&gt;

]

.pull-right[


&lt;img src="images/cwilke_Aus-athletes-big-good-1.png" width="1536" /&gt;

]

--

**Solution**: save the images in _smaller size_ (I recommend 3 by 5 inches; some recommend smaller).


```r
ggsave("figures/figure_rightsize.pdf", `height = 3`, `width = 5`)
```

---

# Also: Use vector graphics where possible


&lt;img src="images/cwilke_bitmap-zoom-1.png" width="100%" /&gt;

Note: panel (b) zooms into the figure in panel (a) when the graph is a raster graphic (like `jpeg` or `png`). panel (c) zooms into the same area when the graph is a vector graphic (like `pdf` or `svg`).


---

# 3. Reader-friendly legends or annotation

## Having to go back and forth between data and legend is not reader-friendly.

.pull-left[

&lt;img src="images/cwilke_tech-stocks-bad-legend-1.png" width="1536" /&gt;

]

--

.pull-right[

&lt;img src="images/cwilke_tech-stocks-good-legend-1.png" width="1536" /&gt;

]


**Solution**: relevel your factors (`fct_relevel`) so the levels align with the data, or ...

---

# Whenever possible, design your figures so they don’t need a legend.

.pull-left[

&lt;img src="images/cwilke_tech-stocks-good-no-legend-1.png" width="1536" /&gt;

]

.pull-right[

pseudo-code:


```r
ggplot(stocks, 
       aes(x = year, 
           y = price, 
           group = company,
           color = company)) + 
  annotate("text", x = 2018, y = 550, label = "Facebook") +
  annotate("text", x = 2018, y = 340, label = "Alphabet") +
  annotate("text", x = 2018, y = 250, label = "Microsoft") +
  annotate("text", x = 2018, y = 195, label = "Apple") +
  labs(x = "", 
       y = "stock price, indexed", 
       color = "color")
```


]

---

# 4. Default colors can be indistinguishable in grayscale

or for colorblind readers

\vspace{-2em}

.pull-left[

&lt;img src="images/cwilke_iris-scatter-one-shape-1.png" width="1536" /&gt;

]

--

.pull-right[

&lt;img src="images/cwilke_iris-scatter-one-shape-cvd-1.png" width="2011" /&gt;

]

--

&lt;b&gt;Solution&lt;/b&gt;: 

* The viridis color scale (`scale_color_viridis_d` or `scale_color_viridis_c`) is a good default.
* Also manually assign values for discrete variables ( `scale_color_manual`)


---
layout: true
&lt;div class="my-footer"&gt;&lt;span&gt;Day 4&lt;/span&gt;&lt;/div&gt;

---
class: middle
name: day4

.pull-left[
# Day 4 Agenda

## Workflow best practices
## RStudio and R Desktop
## Review of key functions via cheatsheet
]


.small-note[
**Notes:**

\* Instead of the original plan, we will _not_ cover Rmarkdown in math camp and instead consolidate what we've learned so far. This prepares us well for Rmarkdown down the road. For those feeling ambitious,  &lt;a href = "https://r4ds.had.co.nz/r-markdown.html"&gt;&lt;i&gt;R for Data Science Chapter 27&lt;/i&gt;&lt;/a&gt; is a good introduction to Rmarkdown. 

\* References for today's material: &lt;a href = "https://r4ds.had.co.nz"&gt;&lt;i&gt;R for Data Science&lt;/i&gt;&lt;/a&gt;  chs. &lt;a href = "https://r4ds.had.co.nz/workflow-scripts.html"&gt;6&lt;/a&gt; and &lt;a href = "https://r4ds.had.co.nz/workflow-projects.html"&gt;8&lt;/a&gt;; &lt;a href = "https://whattheyforgot.org/"&gt;&lt;i&gt;What they forgot to teach you about R&lt;/i&gt;&lt;/a&gt; ch. &lt;a href = "https://whattheyforgot.org/save-source.html"&gt;1&lt;/a&gt;; and &lt;a href = "https://web.stanford.edu/~gentzkow/research/CodeAndData.pdf"&gt;&lt;i&gt;Code and Data for the Social Sciences&lt;/i&gt;&lt;/a&gt; chs. 1 and 7.
]


---
class: middle
name: day04-workflow


# Workflow

.small-note[
Prepare by opening today's rstudio.cloud project and opening `sample_cleaned_script.R` in the `example_scripts` folder
]

---

.pull-left[

# What does good R code look like?

.large[Think of your R script like a &lt;mark&gt;recipe&lt;/mark&gt;]


Good recipes ...

]

---



.pull-left[
# What does good R code look like?

.large[Think of your R script like a &lt;mark&gt;recipe&lt;/mark&gt;]



Good recipes ...


.narrow-space[
&amp;#x2611; Readable to your collaborators

&amp;#x2611; Readable to your future self

&amp;#x2611; Clear (minimizes ambiguity)

&amp;#x2611; Ordered chronologically

&amp;#x2611; Follows convention

]


&lt;img src="images/jg-sheet-pan-pancakes-articleLarge.jpg" width="80%" /&gt;

]


.pull-right[


&lt;img src="images/Rworkflow_recipe.png" width="100%" /&gt;
]


---

# First, load packages (but don't keep installation code)

.pull-left[
&lt;img src="images/Rworkflow_library.png" width="1045" /&gt;
]


---

# Read in data at the top, save output at the end

.pull-left[
&lt;img src="images/Rworkflow_load.png" width="1045" /&gt;
]


.pull-right[
&lt;img src="images/Rworkflow_save.png" width="1043" /&gt;
]

---

# Reorder and re-write frequently into a concise, top-to-bottom ordering

* Remove unnecessary "checks" (like `View(dataset)`, `?ggplot`)
--

* Section your code with comment lines, but be concise 


  
  ```r
  # Load data ---------------------------
  
  # Plot data ---------------------------
  ```
--

* Better to have multiple short scripts than one huge script

        
        00_download.R
        01_explore.R
        ...
        09_model.R
        10_visualize.R
        
--

**Why?** Because you want to be re-running your entire code a lot ...



---

# Restart and Re-run (everything) frequently, as you write code

.pull-left[

## 1. Restart from a clean slate

* Go to top toolbar, `Session` &gt; `Restart R`, or
*  &amp;#x21e7; (shift) +  &amp;#x2318; (command/control)  + `0` (zero)


This will remove

* All objects in the Environment
* All loaded packages
* All user-created functions

&lt;mark&gt; Try this in sample_cleaned_script.R&lt;/mark&gt;
&lt;br&gt;

## \* Warning for old R users

Do **not** put `rm(list = ls())` at the beginning of your code. This only removes objects.

]

--

.pull-right[

## 2. Run all ("source") - and break on first error

* Toolbar `Code` &gt; `Source`, or
* &amp;#x21e7; (shift) + &amp;#x2318; (command/control) + `s` (the letter S, for source)

## \* or run all and show output

* Toolbar `Code` &gt; `Run Region` &gt; `Run All`, or
* &amp;#x21e7; (shift) + &amp;#x2318; (command/control) + &amp;#x23ce; (enter)

## \* or re-run only up to this line

* Toolbar `Code` &gt; `Run Region` &gt; `Run All Chunks Above`, or
* &amp;#x2325; (option/alt) +   &amp;#x2318; (command/control) + `b` (the letter B, for begin)

.small[.right[\* For more shortcuts, see `Tools` &gt; `Keyboard Shortcut Help`]]
]

---
class: center, middle

&lt;mark&gt;Exercise: fix this example bad code so it runs on a blank slate.&lt;/mark&gt;

&lt;img src="images/Rworkflow_exercise-badscript.png" width="40%" /&gt;




---

# File paths  are a way to define the location of a file

* **"Directory"** &amp;#x2248; "Folder".    "Working Directory" = The current folder
* Paths are hierarchical: parent &amp;#x2192; child , separated by a **forward slash** `/` (`project/data/input`)
* **File extensions** are separated by a period `.` (`kuriwaki_shiro.R`, `scatterplot.pdf`)


There are important special characters:

* **Root**: Starting with `/` (or `C:\` in Windows) means the top of computer. `/cloud/project`
* **Home**: Starting with a tilde `~/` means the default home directory -- varies by project. (`~/data/input`)
* &lt;mark&gt;Relative paths&lt;/mark&gt;: Starting with no symbol means "wherever we are now".  (`data/input`)
* A period `./` also means, wherever we are now (`./data/input`)
* **Parent folder**: &lt;u&gt;two&lt;/u&gt; periods move to parent folder (go back up one): `../projects/data/input`

.small[\* You almost never call the root directory, and rarely call the home directory. Instead, do things in relative paths. Fast forward to &lt;a href="#rstudio-project"&gt;RStudio Projects&lt;/a&gt;]


So where is the working directory?
* It depends, but in RStudio, the working directory defaults to the project directory, which is wherever the `.Rproj` file is.
* This is not permanent; you can modify the working directory any time.


---
# Navigating paths - the basics

Shell (or ba&lt;u&gt;sh&lt;/u&gt;, command-line) is a language to navigate folders outside of R

* `pwd ` is -- show me the &lt;u&gt;p&lt;/u&gt;resent (current) working directory (`getwd()` in R)
* `cd ` is -- &lt;u&gt;c&lt;/u&gt;hange the directory to the following path  (`setwd()` in R)



---

# Exercise your path reading skills

&lt;mark&gt;1. How would you read the following paths?&lt;/mark&gt;
&lt;br&gt;


```r
weo &lt;- read_excel("data/input/WEO-2018.xlsx")
```



```r
weo &lt;- read_csv("~/Dropbox/API-209/Problem Sets/ps01/data/input/WEO-2018.xlsx")
```



```r
ggsave("figures/percapita_growth_figure.pdf")
```

--

&lt;br&gt;
&lt;mark&gt; 2. Why would defining everything in absolute paths be a bad idea?&lt;/mark&gt;
--

1. Too long
2. Not sharable: `setwd("path/that/only/works/on/my/machine")`


---
class: center, middle
name: day04-download-desktop

# Download R Desktop (in preparation for tomorrow)

---

# Download for Tomorrow: &lt;u&gt;Newest&lt;/u&gt; Versions of R Desktop and RStudio Desktop

.pull-left[

## R is the software

1. Google "download R" (or .small[&lt;http://www.r-project.org/&gt;])
2. Go to "download" R, and pick the first mirror

 &lt;img src="images/Rdownload_homepage.png" width="80%" /&gt;

3. Download the installer for your Operating System (Mac or Windows)

&lt;img src="images/Rdownload_mirror.png" width="80%" /&gt;

]

--

.pull-right[
## RStudio is the IDE and GUI

1. Google "download RStudio" (or .small[&lt;http://www.rstudio.com/products/rstudio/download&gt;])
2. Download the Installer for Mac/Windows

&lt;img src="images/Rdownload_rstudio.png" width="80%" /&gt;

.narrow-space[.small[
IDE: Integrated Development Environment. 

GUI: Graphical User Interface

]]



]

.small[Note: We will put all of this to action on Tuesday.]

---
class: middle, center
name: day04-cheatsheet


# Wrap-up and review of key commands


---

# Are you familiar with the functions on the cheatsheet?

Follow along on the cheat-sheet: &lt;http://bit.ly/HKS-R&gt;

.left-code[
1. Object assignment
2. dplyr verbs
3. ggplot layers
4. Base-R vectors and data-frames
5. Summary functions
6. Input / Output
7. Combining datasets (new topic)
]

.right-wide[

We didn't get to cover these cheatsheet functions which come up fairly often --

* `::` - call function directly from package
* `unique`, `n_distinct`: unique values
* `summary`: generic function, output varies by object 
* `str`: general structure
* `geom_histogram()`, `geom_bar()`: geoms that involve aggregation
* `fill` vs. `color` aesthetics: fill is the inside of a polygon; color is the border line
* `write_csv`: saving to a spreadsheet
* `bind_rows`: stack rows
* `left_join`, `inner_join`: merge multiple datasets

]

---
layout: true
&lt;div class="my-footer"&gt;&lt;span&gt;Day 5&lt;/span&gt;&lt;/div&gt;

---
class: middle
name: day5


# Day 5 Agenda


## Discuss presentations
## R Desktop
## Getting help effectively

&lt;br&gt;
&lt;br&gt;


.small-note[
**Notes:**

\* References for today's material: &lt;a href = "https://whattheyforgot.org/"&gt;&lt;i&gt;What they forgot to teach you about R&lt;/i&gt;&lt;/a&gt; ch. &lt;a href = "https://whattheyforgot.org/save-source.html"&gt;1&lt;/a&gt; and &lt;a href = "https://whattheyforgot.org/project-oriented-workflow.html"&gt;2&lt;/a&gt;; &lt;a href = "https://rstudio-education.github.io/hopr"&gt;&lt;i&gt;Hands-on Programming with R&lt;/i&gt;&lt;/a&gt; ch. &lt;a href = "https://rstudio-education.github.io/hopr/starting.html"&gt;A&lt;/a&gt;.
]


---
class: center, middle


# Presentations


---
class: center, middle
name: name: day04-desktop


# Getting to work with R Desktop

---

# Step 1: Create an API-209 folder


Choose a directory to put all your work in (e.g. `~/Dropbox`/ `C:\Dropbox`, or `~/Documents`)

--

&amp;#x2B91; under it, create a `API-209` folder (avoid spaces in your folder names)

&amp;#x2B91; under that, create a `Problem-Sets` folder

&amp;#x2B91; under that, create folders `PS-01`, `PS-02`, .small[(adding a 0 makes it easy to sort when you get to `PS-10`)]

&amp;#x2B91; for each problem set folder, create a `data` folder with subfolders `input` and `output` 


.small-note[

\* You can deviate this from later, but these are well-established practices worth trying first. It's better to try out some established convention rather than re-inventing the wheel. See e.g. &lt;a href="http://web.stanford.edu/~gentzkow/research/CodeAndData.pdf"&gt;"Code and Data for the Social Sciences: A Practitioner’s Guide"&lt;/a&gt; and &lt;a href="https://doi.org/10.1371/journal.pcbi.1005510"&gt;"Good enough practices in scientific computing"&lt;/a&gt; 
]

---

# Step 2: Open RStudio from Applications

&lt;img src="images/Rstudio-emptyproject.png" width="75%" style="display: block; margin: auto;" /&gt;


---

# Step 2(a): Change global options so restarting entails clean slate

.pull-left[
* Change your Global settings to &lt;u&gt;not&lt;/u&gt; save data
* To do this, Go to Toolbar `Tools` &gt; `Global Options` and change the sections highlighted in red arrows as shown here:
]

.pull-right[

&lt;img src="images/rstudio-workspace.png" width="80%" /&gt;

]

---
# Step 2(b): Install key packages

&lt;br&gt;

&lt;br&gt;

You only need to do this once, so do this in the Console without any script


```r
install.packages(c("tidyverse", "readxl", "haven"))
```

You can install and update packages later.

---

# Step 3: Create a New Project

* Toolbar `File` &gt; `New Project` or the icon: &lt;img / src = "images/project-add-icon.png"/&gt;

.pull-left[

&lt;img src="images/rstudio-project-existing.png" width="80%" /&gt;

]

.pull-right[

&lt;img src="images/rstudio-project-path.png" width="80%" /&gt;

]

---
name:rstudio-project

# Orient yourself - where is the working directory?

1. The &lt;u&gt;project&lt;/u&gt; directory is wherever the `.Rproj` file is
2. Rstudio Projects are created so that the &lt;mark&gt;working directory&lt;/mark&gt; defaults to the &lt;u&gt;project directory&lt;/u&gt;


&lt;img src="images/rstudio-ps-01.png" width="70%" style="display: block; margin: auto;" /&gt;


---

# Practice Project-Oriented Workflow

&lt;br&gt;


* .slarge[Create an RStudio project &lt;u&gt;for each data analysis project&lt;/u&gt;.]

--

* .slarge[Keep &lt;u&gt;data files&lt;/u&gt; there; we’ll talk about loading them into R in data import.]

* .slarge[Keep &lt;u&gt;scripts&lt;/u&gt; there; edit them, run them in bits or as a whole.]

* .slarge[Save your &lt;u&gt;outputs&lt;/u&gt; (plots and cleaned data) there.]

* .slarge[Only ever use &lt;u&gt;relative paths&lt;/u&gt;, not absolute paths]


.small-note[
\* Taken from &lt;a href="https://r4ds.had.co.nz/workflow-projects.html"&gt;R for Data Science Chapter 8&lt;/a&gt; 
]

---

# Going beyond defaults 

.pull-left[

## setwd()

* You can change working directories by the R command `setwd()`
* You can change it back by Toolbar: `Session` &gt; `Set Working Directory` &gt; `To Project Directory`

]

--

.pull-right[

## Your script location is independent from the project

&lt;img src="images/project-mixup.png" width="75%" style="display: block; margin: auto;" /&gt;

.small-note[\* If you open a script for problem set 1 in the problem set 2 RStudio Project, the working directory still defaults to `Problem-Sets/PS-02`]

]


---

# Leverage the features of the RStudio IDE

.pull-left[

## Technically, R is only the Console

&lt;img src="images/R-console.png" width="75%" style="display: block; margin: auto;" /&gt;

]

.pull-right[

## RStudio is a GUI - access R _via_ RStudio

&lt;img src="images/Rstudio-emptyproject.png" width="80%" /&gt;


## As an IDE, Rstudio includes more tools

* &lt;a href = "https://r4ds.had.co.nz/r-markdown.html"&gt;Rmarkdown&lt;/a&gt;
* Shiny apps (interactive web apps)
* Terminal (command-line tools)
* Git (version control)

]


---

# Step 4: Test your Assignment

&lt;br&gt;
&lt;br&gt;

Assignment for end of today (mandatory)

&gt; Take your summer assignment R script you created, and adapt so that is both (a) &lt;u&gt;correct&lt;/u&gt; and (b) &lt;u&gt; replicable&lt;/u&gt; on a project. Create a project specific to the summer assignment. 

Materials on Canvas, &lt;a href= "https://canvas.harvard.edu/courses/62068/assignments/303684"&gt; R day 5 exercise&lt;/a&gt;



---

# Running R for Problem Sets

.pull-left[

## Preparation

1. Create a designated folder (e.g. `PS-04`)
2. Create subfolders for data, figures, etc..
3. Download problem set and data files
4. Create a &lt;u&gt;Rstudio Project&lt;/u&gt; for that project folder

]

--

.pull-right[

## Analysis

API-209 problem sets will generally be in a fillable word doc.

&lt;img src="images/problemset-look.png" width="80%" /&gt;


]


---
class: center, middle
name: day05-getting-help

# Final Tips for your own R experience


---

# Take advantage of the R community

.pull-left[

## Resources

* **Class instructors and resources**

Also helpful:

* Stackoverflow (.small[&lt;https://stackoverflow.com/&gt;])
* Community boards (e.g. .small[&lt;http://community.rstudio.com&gt;])
* Twitter?

&lt;blockquote class="twitter-tweet" data-lang="en"&gt;&lt;p lang="en" dir="ltr"&gt;What &lt;a href="https://twitter.com/hashtag/rstats?src=hash&amp;amp;ref_src=twsrc%5Etfw"&gt;#rstats&lt;/a&gt; tricks did it take you way too long to learn? One of mine is using readRDS and saveRDS instead of repeatedly loading from CSV&lt;/p&gt;&amp;mdash; Emily Riederer (@EmilyRiederer) &lt;a href="https://twitter.com/EmilyRiederer/status/898735640031920129?ref_src=twsrc%5Etfw"&gt;August 19, 2017&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src="https://platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;

]


--

.pull-right[

## Stuck? 

Help us help you by making your errors reproducible


* Code and/or Screenshots
* Or even better: `reprex`


```r
install.packages("reprex")
library(reprex)
```

Copy the problematic code to your clipboard, 

```r
library(forcats)
data(gss_cat)

xtabs(rincome + race, gss_cat)
```

and separately run `reprex()`

]

---
class: center, middle

# Thanks!

Please be sure to send us any feedback in the end of math camp survey.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="https://platform.twitter.com/widgets.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"highlightSpans": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
